删除备集群 
==========================

本节主要介绍如何删除备集群。

通过命令行删除备集群 
-------------------------------

在主备库的日常维护过程中，如果需要删除某个集群，则需要确认该集群的角色以及该集群是否在主备库配置中。

如果需要从主备库配置中删除备集群，则需要在主集群上执行删除命令，将目标集群从主备库配置中移除。

删除集群的命令如下：

```sql
obclient> ALTER SYSTEM REMOVE CLUSTER cluster_name CLUSTER_ID cluster_id [FORCE];
```



命令执行说明：

* 命令中，`cluster_name`、`cluster_id` 为待删除的集群的集群名称和 ID。

  

* 当前支持在主集群上执行删除备集群的命令，如果必须在备集群上执行，则命令中需要添加 `FORCE` 关键字，同时还要保证该备集群在主备库配置中，并且待删除的集群不是当前集群。

  

* 在最大保护模式和最大可用模式下，不支持删除 `SYNC` 模式的备集群。

  




另外，在删除集群时，被删除的目标集群的角色不一定是备集群。执行 Failover 后，会出现两个主集群角色：新主集群和原主集群，这两个集群都在主备库配置中，Failover 相关操作请参见 [Failover](7.role-switch-3/4.run-a-failover-command-from-the-command-line-1/1.prepare-for-failover-1.md)章节。

您可以选择保留一个集群作为目标主集群，删除另一个集群。例如，您可以选择保留新主集群作为目标主集群，删除原主集群；也可以恢复原主集群服务，删除新主集群。删除其中一个主集群时，需要在保留的主集群上执行 `REMOVE CLUSTER` 命令，将其从主备库配置中删除，否则会残留不存在的集群配置。

通过 OCP 下线备集群 
---------------------------------

**注意**



OCP V2.5.0 及之前版本在删除集群时存在缺陷，只有当被删除的集群的角色为备集群时，才会去主集群上执行 `REMOVE CLUSTER` 命令。Failover 后，删除不需要的主集群时，OCP 不会在保留的主集群上执行 `REMOVE CLUSTER` 命令，这样会导致残留不需要的主集群的配置。故在使用 OCP V2.5.0 及之前版本下线备集群时，您需要通过命令行登录保留的主集群，手动执行命令删除不需要的主集群配置。

1. 登录 OCP 。默认进入 **集群概览** 页面。

   

2. 在 **集群概览** 页面的 **集群列表** 区域，选择待删除的集群并单击其集群名。

   

3. 在 **总览** 页面的右上角，单击 **...** 图标，选择 **删除集群** 。

   

4. 在弹出的 **删除集群** 对话框中，输入 delete，单击 **删除** 。![delete](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/3048190061/p168775.png)

   




V2.2.30-BP18 
=================================
#docslug#/oceanbase-database/oceanbase-database/V4.0.0/v2-2-30-bp18


版本信息 
-------------------------



|  类目  |       描述       |
|------|----------------|
| 版本号  | V2.2.30-BP18   |
| 前置版本 | V2.2.20        |
| 发布时间 | 2021 年 7 月 8 日 |



适用版本 
-------------------------

支持从 V2.2.1-20200731153445 版本和 V2.2.20 版本直接升级到本版本。
**注意**



* 从 V2.2.1 版本升级到 V2.2.30 版本必须使用 V2.2.30-BP10 及以上版本。

  

* 如果从低版本升级到 V2.2.1 再升级到 V2.2.30，请确保升级到的 V2.2.1 版本是 V2.2.1-1865649 及之后的版本，并且升级到 V2.2.1 后合并或者转储一轮之后才能继续升级到 V2.2.30。

  




功能优化 
-------------------------

* 优化器针对超大分区进行估行采样优化。

  

*
  新增支持通过 unix socket domain 方式链接 MySQL 租户。
  




修复的问题 
--------------------------

* 修复了节点 crash 产生 core dump 过程中，没有关闭 fd，导致其他节点仍然发 RPC 到当前 core 节点。

  

* 修复了 Data 盘无响应时无法自动侦测和识别。

  

*
  修复了在 nested loop join 查询场景下，如果有回表操作，并且查询的行是 memstore 转储后 relocate 的行，进而导致 crash 的问题。
  




已知问题 
-------------------------

* Oracle 模式下，不建议使用 nvarchar2 类型，使用该类型可能导致查询的 SQL 线程无响应。

  

* Oracle 模式下，sql_mode 如果设置为 PAD_CHAR_TO_FULL_LENGTH 可能导致查询正确性问题。

  

* Oracle 模式下查询系统视图带有别名会导致报错。

  




版本使用限制 
---------------------------

* 禁止将 clog 和数据放入同一个磁盘，尤其是机械磁盘。此情况下 CLOG 写盘有延迟可能导致 observer crash 问题。此外，clog 盘 IO 满可能导致系统核心表无 leader。

  

* 禁止 Oceanbase 数据库运行过程中将操作系统时间向过去回调。

  

* Oracle 模式不建议使用 nvarchar2。

  





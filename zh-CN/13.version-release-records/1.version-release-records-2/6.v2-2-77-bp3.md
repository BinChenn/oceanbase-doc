V2.2.77-BP3 
================================
#docslug#/oceanbase-database/oceanbase-database/V4.0.0/v2-2-77-bp3


版本信息 
-------------------------



|  类目  |       描述        |
|------|-----------------|
| 版本号  | V2.2.77-BP3     |
| 前置版本 | V2.2.76         |
| 发布时间 | 2021 年 6 月 18 日 |



适用版本 
-------------------------

支持从 V2.2.50、V2.2.51、V2.2.52、V2.2.60、V2.2.70、V2.2.71、V2.2.72、V2.2.73、V2.2.74、V2.2.75 和 2.2.76 版本升级到本版本。

功能优化 
-------------------------

* MySQL mode 支持 log/ln/pi/radians/atan/asin/acos/cot 函数。

  

* MySQL mode 支持 monthname。

  

* MySQL mode 支持 last_day 函数。

  

* MySQL mode 支持 quarter 函数。

  




修复的问题 
--------------------------

* 修复了 query 回包过程网络问题导致回包失败导致的 observer crash 的问题。

  

* 修复了并行框架内存泄漏的问题。

  

* 修复了获取 partition location 时并发申请内存导致的 observer crash。

  

* 修复了 plan cache 模块 evict 过程可能访问空指针导致 observer crash 的问题。

  

* 修复了匿名块中包含大量的静态 SQL（未开启 prepare statment) 引发栈溢出导致 observer crash。

  

* 修复了 SQL 改写导致的 self anti join 估行错误的问题。

  

* 修复了日志归档引发的 OB_ARCHIVE_TEMP_MEMORY mod 内存泄漏问题。

  

* 修复了 PL 无法命中 plan cache 的问题。

  

*
  修复了当客户端主动断开连接后 observer 仍然保留 session 的问题。
  




版本使用限制 
---------------------------

* PL debug 功能仅限 x86 平台使用，ARM 平台上不推荐使用。

  

* MySQL 模式下当 PL 里包含多条 SQL 时可能引起正确性问题。

  

* 主备库升级目前仅支持最大性能模式下升级，如果升级之前是最大保护模式或者最大可用模式，需要先降级为最大性能模式再执行集群升级。

  

* 使用了国密的 V2.2.77 版本不能升级到 V3.1.2-20211013162404（BP4）及之前的版本。

  





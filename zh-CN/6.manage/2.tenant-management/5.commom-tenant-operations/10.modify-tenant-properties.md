# 修改租户属性

修改用户租户属性，包括修改租户的副本数、Zone 列表、主 Zone 以及系统变量值等。本文介绍如何修改租户属性。

租户属性可以通过 `ALTER TENANT` 语句进行修改。

## 操作步骤

1. 使用 root 用户登录到数据库的 sys 租户。

    ```sql
    $obclient -h172.30.xx.xx -P2883 -uroot@sys#cluster -p**** -A
    ```

2. 进入 OceanBase 数据库。

    ```sql
    obclient [(none)]> USE oceanbase;
    ```

3. 通过 `DBA_OB_TENANTS` 视图，查看租户 `mq_t1` 的配置信息。

    ```sql
    obclient [oceanbase]> SELECT * FROM DBA_OB_TENANTS WHERE TENANT_NAME = 'mq_t1';
    +-----------+-------------+-------------+----------------------------+----------------------------+--------------+------------------------------+-------------------+--------------------+--------+---------------+--------+
    | TENANT_ID | TENANT_NAME | TENANT_TYPE | CREATE_TIME                | MODIFY_TIME                | PRIMARY_ZONE | LOCALITY                     | PREVIOUS_LOCALITY | COMPATIBILITY_MODE | STATUS | IN_RECYCLEBIN | LOCKED |
    +-----------+-------------+-------------+----------------------------+----------------------------+--------------+------------------------------+-------------------+--------------------+--------+---------------+--------+
    |      1036 | mq_t1       | USER        | 2023-01-10 22:44:59.788717 | 2023-01-10 22:45:19.578586 | zone1;zone2  | FULL{1}@zone1, FULL{1}@zone2 | NULL              | MYSQL              | NORMAL | NO            | NO     |
    +-----------+-------------+-------------+----------------------------+----------------------------+--------------+------------------------------+-------------------+--------------------+--------+---------------+--------+
    1 row in set
    ```

    `DBA_OB_TENANTS` 视图的详细说明，请参见 [oceanbase.DBA_OB_TENANTS](../../../7.reference/5.system-reference/4.system-view-of-mysql-mode/2.dictionary-view-of-mysql-mode/58.oceanbase-dba_ob_tenants-of-mysql-mode.md) 

4. 修改租户的 Primary Zone 为 `"zone1,zone2"`，Locality 为 `"F@sa128_obv4_1,F@sa128_obv4_2,F@sa128_obv4_3"`。
   `RESOURCE_POOL_LIST` 表示资源池列表，每次仅支持添加或删除一个资源池。不支持直接替换租户的资源池。租户原来使用的资源池为 `mq_pool_01`，通过以下命令直接将租户的资源池替换为 `mq_pool_02` 时，系统会报错。

    ```sql
    obclient [oceanbase]> ALTER TENANT mq_t1 PRIMARY_ZONE='zone1,zone2';
    Query OK, 0 rows affected

    obclient [oceanbase]> ALTER TENANT mq_t1 locality="F@zone1,F@zone2,F@zone3";
    Query OK, 0 rows affected

    obclient [oceanbase]> ALTER TENANT mq_t1 RESOURCE_POOL_LIST=('mq_pool_02');
    ERROR 1210 (HY000): Incorrect arguments to resource pool list
    ```

    参数说明：

    * PRIMARY_ZONE：用于指定租户的 Primary Zone。
    * locality：描述副本在 Zone 间的分布情况，如：`F@zone1,F@zone2,F@zone3` 表示 `zone1`、`zone2` 和 `zone3` 为全功能副本。该参数增加 zone 配置时需要租户资源池的 ZONE_LIST 包含该 zone。

    `ALTER TENANT` 语句的详细说明，请参见 [ALTER TENANT](../../../7.reference/4.development-guide-refactoring/1.sql-syntax/1.system-tenants/5.alter-tenant.md)。

5. 查看 `DBA_OB_TENANTS` 视图，确认修改结果。

    结果如下，可以看到 PRIMARY_ZONE、LOCALITY 参数已经更新。

    ```sql
    obclient [oceanbase]> SELECT * FROM DBA_OB_TENANTS WHERE TENANT_NAME = 'mq_t1';
    +-----------+-------------+-------------+----------------------------+----------------------------+--------------+---------------------------------------------+------------------------------+--------------------+--------+---------------+--------+
    | TENANT_ID | TENANT_NAME | TENANT_TYPE | CREATE_TIME                | MODIFY_TIME                | PRIMARY_ZONE | LOCALITY                                    | PREVIOUS_LOCALITY            | COMPATIBILITY_MODE | STATUS | IN_RECYCLEBIN | LOCKED |
    +-----------+-------------+-------------+----------------------------+----------------------------+--------------+---------------------------------------------+------------------------------+--------------------+--------+---------------+--------+
    |      1014 | mq_t1       | USER        | 2023-01-06 15:39:57.422331 | 2023-01-10 20:02:47.387161 | zone1,zone2  | FULL{1}@zone1, FULL{1}@zone2, FULL{1}@zone3 | FULL{1}@zone1, FULL{1}@zone2 | MYSQL              | NORMAL | NO            | NO     |
    +-----------+-------------+-------------+----------------------------+----------------------------+--------------+---------------------------------------------+------------------------------+--------------------+--------+---------------+--------+
    1 row in set
    ```

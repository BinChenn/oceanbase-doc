# 创建资源池

在创建租户前，需要先确定租户的资源规格和资源使用范围。本文介绍如何创建资源池。

## 前提条件

创建资源池时需要指定其资源规格。在执行创建资源池操作前，请确认是否有可用的资源规格。有关创建资源规格的详细操作，请参见 [创建资源规格](1.create-resource-specifications.md)。

## 操作步骤

1. 使用 root 用户登录到数据库的 sys 租户。

    ```sql
    $obclient -h172.30.xx.xx -P2883 -uroot@sys#cluster -p**** -A
    ```

2. 进入 oceanbase 数据库。

    ```sql
    obclient [(none)]> USE oceanbase;
    ```

3. 通过 `DBA_OB_RESOURCE_POOLS` 视图，获取资源配置信息。

    ```sql
    obclient [oceanbase]> SELECT * FROM DBA_OB_RESOURCE_POOLS;
    +------------------+--------------------------+-----------+----------------------------+----------------------------+------------+----------------+-------------------+--------------+
    | RESOURCE_POOL_ID | NAME                     | TENANT_ID | CREATE_TIME                | MODIFY_TIME                | UNIT_COUNT | UNIT_CONFIG_ID | ZONE_LIST         | REPLICA_TYPE |
    +------------------+--------------------------+-----------+----------------------------+----------------------------+------------+----------------+-------------------+--------------+
    |                1 | sys_pool                 |         1 | 2022-12-20 17:50:17.038641 | 2022-12-20 17:50:17.045453 |          1 |              1 | zone1;zone2;zone3 | FULL         |
    |             1001 | pool_mysql001_zone3_jsu  |      1002 | 2022-12-20 18:04:31.607227 | 2022-12-20 18:04:31.692836 |          1 |           1003 | zone3             | FULL         |
    |             1002 | pool_mysql001_zone1_okz  |      1002 | 2022-12-20 18:04:31.617087 | 2022-12-20 18:04:31.691827 |          1 |           1001 | zone1             | FULL         |
    |             1003 | pool_mysql001_zone2_pme  |      1002 | 2022-12-20 18:04:31.621327 | 2022-12-20 18:04:31.692836 |          1 |           1002 | zone2             | FULL         |
    |             1013 | pool_oracle001_zone3_exu |      1010 | 2022-12-26 18:28:37.979539 | 2022-12-26 18:28:38.059505 |          1 |           1013 | zone3             | FULL         |
    |             1014 | pool_oracle001_zone1_owy |      1010 | 2022-12-26 18:28:37.988964 | 2022-12-26 18:28:38.058440 |          1 |           1015 | zone1             | FULL         |
    |             1015 | pool_oracle001_zone2_hli |      1010 | 2022-12-26 18:28:37.994241 | 2022-12-26 18:28:38.059505 |          1 |           1014 | zone2             | FULL         |
    +------------------+--------------------------+-----------+----------------------------+----------------------------+------------+----------------+-------------------+--------------+
    7 rows in set
    ```

   `DBA_OB_RESOURCE_POOLS` 视图的详细说明，请参见 [oceanbase.DBA_OB_RESOURCE_POOLS](../../../7.reference/5.system-reference/4.system-view-of-mysql-mode/2.dictionary-view-of-mysql-mode/47.oceanbase-dba_ob_resource_pools-of-mysql-mode.md)。

4. 通过 `CREATE RESOURCE POOL` 语句，创建资源池。

   在本示例中，创建了一个名为 `mq_pool_01` 的资源池，并在 zone1、zone2 里各创建 1 个 unit，每个 unit 的资源规格为 `S1_unit_config`。

    ```sql
    obclient [oceanbase]> CREATE RESOURCE POOL mq_pool_01 
                    UNIT='S1_unit_config', 
                    UNIT_NUM=1, 
                    ZONE_LIST=('zone1','zone2'); 
    ```

   参数说明：

   * UNIT：该资源池的资源规格。
   * ZONE_LIST：资源池的 Zone 分布。OceanBase 数据库会在 ZONE_LIST 描述的每个 Zone 里面创建 UNIT_NUM 个 unit，每个 unit 的资源规格为 UNIT 参数设置的值。
   * UNIT_NUM：该资源池在目标 Zone 的 unit 个数，它的值要小于目标 Zone 的节点个数，且每个节点上最多只能分布同一个租户的一个 unit。

   `CREATE RESOURCE POOL` 语句的详细说明，请参见 [CREATE RESOURCE POOL](../../../7.reference/4.development-guide-refactoring/1.sql-syntax/1.system-tenants/6.create-resource-pool.md)。

5. 查询 `DBA_OB_RESOURCE_POOLS` 视图，确认创建成功。

    ```sql
    obclient [oceanbase]> SELECT * FROM DBA_OB_RESOURCE_POOLS WHERE NAME = 'mq_pool_01';
    +------------------+------------+-----------+----------------------------+----------------------------+------------+----------------+-------------+--------------+
    | RESOURCE_POOL_ID | NAME       | TENANT_ID | CREATE_TIME                | MODIFY_TIME                | UNIT_COUNT | UNIT_CONFIG_ID | ZONE_LIST   | REPLICA_TYPE |
    +------------------+------------+-----------+----------------------------+----------------------------+------------+----------------+-------------+--------------+
    |             1024 | mq_pool_01 |      NULL | 2023-01-10 22:37:08.212366 | 2023-01-10 22:37:08.212366 |          1 |           1020 | zone1;zone2 | FULL         |
    +------------------+------------+-----------+----------------------------+----------------------------+------------+----------------+-------------+--------------+
    1 row in set
    ```

## 更多信息

资源池创建后，您可以根据业务需要，将资源池分配给租户，也可以修改资源池属性。详细操作，请参见：

* [创建租户](3.create-tenant.md)

* [修改资源池属性](9.modify-resource-pool-properties.md)

* [删除资源池](14.delete-resource-pool.md)

# 登录租户

创建租户后，可以登录租户创建各种数据库对象（Database、Table、用户等）。

## 登录用户租户

使用 root 用户登录到 cluster 集群的 mysql001 租户，示例如下：

```sql
$obclient -h172.30.xx.xx -P2883 -uroot@mysql001#cluster -p****
```

参数说明：

* **-h**：OceanBase 数据库连接 IP，也可以是 OBProxy 地址。
* **-u**：租户的连接用户名，格式为 **用户@租户#集群名称**，集群的默认管理员租户是 'sys'，租户的默认管理员用户是 root。直连数据库时不填写集群名称，通过 OBProxy 连接时需要填写。
* **-p**：用户密码。
* **-P**：OceanBase 数据库连接端口，也是 OBProxy 的监听端口。可以自行配置，OBProxy 常用端口为 2883，直连常用端口为 2881。

### 本机直连登录用户租户

当租户连接的白名单只设置了本机地址时，则无法远程访问数据库。需要登录数据库所在节点，再通过本机地址登录用户租户。

1. 使用 root 用户登录到数据库的 sys 租户。

    ```sql
    $obclient -h172.30.xx.xx -P2883 -uroot@sys#cluster -p**** -A
    ```

2. 进入 oceanbase 数据库。

    ```sql
    obclient [(none)]> USE oceanbase;
    ```

3. 查看所有租户的 TENANT_ID 信息。

    ```sql
    obclient [oceanbase]> SELECT TENANT_ID,TENANT_NAME FROM DBA_OB_TENANTS;
    +-----------+-------------+
    | TENANT_ID | TENANT_NAME |
    +-----------+-------------+
    |         1 | sys         |
    |      1001 | META$1002   |
    |      1002 | mysql001    |
    |      1009 | META$1010   |
    |      1010 | oracle001   |
    |      1035 | META$1036   |
    +-----------+-------------+
    6 rows in set
    ```

4. 查询 oracle001 租户在哪些节点上有 unit。

    ```sql
    obclient [oceanbase]> SELECT UNIT_ID,STATUS,ZONE,SVR_IP FROM dba_ob_units WHERE TENANT_ID = 1010;
    +---------+--------+-------+--------------+
    | UNIT_ID | STATUS | ZONE  | SVR_IP       |
    +---------+--------+-------+--------------+
    |    1013 | ACTIVE | zone3 | xx.xx.xx.102 |
    |    1014 | ACTIVE | zone1 | xx.xx.xx.103 |
    |    1015 | ACTIVE | zone2 | xx.xx.xx.104 |
    +---------+--------+-------+--------------+
    ```

5. 通过 ssh 方式登录节点 `xx.xx.xx.102`。

    ```bash
    $ssh admin@xx.xx.xx.102
    admin@xx.xx.xx.102's password:
    ```

6. 再通过客户端登录到用户租户。

   示例：

   * 通过 OBClient 客户端登录 Oracle 兼容模式的租户。

      ```bash
      $obclient -P2881 -h127.0.0.1 -usys@oracle001 -p**** -A
      Welcome to the OceanBase.  Commands end with ; or \g.
      Your OceanBase connection id is 3222649039
      Server version: OceanBase 4.0.0.0 (r101000022022120716-0d7927892ad6d830e28437af099f018b0ad9a322) (Built Dec  7 2022 16:22:15)

      Copyright (c) 2000, 2018, OceanBase and/or its affiliates. All rights reserved.

      Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

      obclient [SYS]>
      ```

      <main id="notice" type='explain'>
       <h4>说明</h4>
       <p>OBClient 是 OceanBase 数据库的登录客户端，可以支持连接 MySQL 兼容模式租户和 Oracle 兼容模式租户。</p>
      </main>

   * 通过 MySQL 客户端登录 MySQL 兼容模式的租户。

      ```bash
      $ mysql -P2881 -h127.0.0.1 -uroot@mysql001 -p**** -A 
      Welcome to the MariaDB monitor.  Commands end with ; or \g.
      Your MySQL connection id is 3222598219
      Server version: 5.7.25 OceanBase 4.0.0.0 (r101000022022120716-0d7927892ad6d830e28437af099f018b0ad9a322) (Built Dec  7 2022 16:22:15)

      Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.

      Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

      MySQL [none]>
      ```

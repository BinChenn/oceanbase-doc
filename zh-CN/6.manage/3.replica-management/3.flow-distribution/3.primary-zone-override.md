# Primary Zone 改写

用户设置的 Primary Zone 会由 OceanBase 数据库基于各个 Zone 所在的 Region 进行改写，改写规则如下：

* 将用户设置的 Primary Zone 中的所有 Zone 对应的 Region 列出。例如：primary_zone 为 'hz1,hz2;sh1,sh2;sz1' 对应的 primary_region 的列表为 'hz,hz;sh,sh;sz'。

* 将 primary_region 中重复的 Region 去掉，去掉规则为保留第一个出现的 Region，其他 Region 后续重复的 Region 移除，例如 'hz1,hz2;sh1,sh2;sz1' ，其 primary_region 转化为列表 'hz;sh;sz'。
  
* 依据 primary_region 中各 Region 的优先级，对 primary_zone 进行补充，补充规则如下：将 Primary Zone 中各 Region 对应的 Zone 都取出，重新排列，高优先级 Region 内 Zone 比低优先级 Region 内 Zone 的优先级高，同一 Region 内 Zone 的优先级高低参考原始 Primary Zone 中的优先级。

例如：

假设共有 9 个 Zone，sh1、sh2、sh3 三个 Zone 在 Region SH，hz1、hz2、hz3 三个 Zone 在 Region HZ，sz1、sz2、sz3 三个 Zone 在 Region SZ。

* 用户设置的 primary_zone 为 'sh1;hz1;hz2;sz1'; 按照改写规则 1 得到 primary_region 为 'SH;HZ;HZ;SZ'。按照改写规则 2 得到 primary_zone 为 'SH;HZ;SZ'。按规则 3 得到改写后 primary_zone 为 'sh1;sh2,sh3;hz1;hz2;hz3;sz1;sz2,sz3'。

* 用户设置的 primary_zone 为 'sh1,sh2;hz1;hz2;sz1'; 按照改写规则 1 得到 primary_region 为 'SH,SH;HZ;HZ;SZ'。按照改写规则 2 得到 primary_zone 为 'SH;HZ;SZ'。按规则 3 得到改写后 primary_zone 为 'sh1,sh2;sh3;hz1;hz2;hz3;sz1;sz2,sz3'。

* 用户设置的 primary_zone 为 'sh1,hz1;hz2;sz1'; 按照改写规则 1 得到 primary_region 为 'SH,HZ;HZ;SZ'。按照改写规则 2 得到 primary_zone 为 'SH,HZ;SZ'。按规则 3 得到改写后 primary_zone 为 'sh1,hz1;hz2;sh2,sh3,hz3;sz1;sz2,sz3'。

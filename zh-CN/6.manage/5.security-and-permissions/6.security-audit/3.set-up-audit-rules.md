# 设置审计规则

开启安全审计后，需要设置具体的安全审计规则来对用户的操作进行审计。

通过内置的审计管理用户 ORAAUDITOR 可以配置审计规则，包括：

* 语句审计：对特定的操作进行审计，不指定具体对象，可以指定对具体用户或对所有用户生效。
* 对象审计：对特定的对象上执行的特定操作进行审计，可以指定对具体用户或对所有用户生效。

审计规则是通过 DDL 语句 audit/noaudit 语句来配置，审计规则也是一种 schema 对象。

## 示例：审计指定用户的登录

以 `ORAAUDITOR` 用户登录，设置审计用户 `aud` 登录。

```sql
obclient> AUDIT SESSION BY user1;
```

## 示例：审计所有用户的登录

以 `ORAAUDITOR` 用户登录，设置审计所有用户登录。

```sql
obclient> AUDIT SESSION;
```

## 示例：审计指定用户在所有表上成功的 DDL 操作

以 `ORAAUDITOR` 用户登录，设置审计用户 `user1` 在所有表上成功的 DDL 操作。

```sql
obclient> AUDIT TABLE BY user1 WHENEVER SUCCESSFUL;
```

## 示例：审计指定用户的所有操作，包括登录退出

以 `ORAAUDITOR` 用户登录，设置审计用户 `user1` 的所有操作。

```sql
obclient> AUDIT ALL STATEMENTS BY user1;
```

## 示例：审计单个用户在数据库对象上的操作

以 `ORAAUDITOR` 用户登录，设置审计 `aud` 用户在 `tab1` 上的插入操作。

```sql
obclient> AUDIT INSERT ON tab1 BY aud;
```

## 示例：审计所有用户在数据库对象上的操作

以 `ORAAUDITOR` 用户登录，设置审计所有用户在 `tab1` 这张表上失败的 DML 操作。

```sql
obclient> AUDIT INSERT, UPDATE, DELETE ON tab1 WHENEVER NOT SUCCESSFUL;
```

## 相关文档

有关安全审计的更多相关操作，参见：

* [开启安全审计](2.audit-open.md)
* [查看审计规则](4.view-audit-rules.md)
* [查看审计记录](5.audit-process.md)


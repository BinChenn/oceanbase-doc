# 登录失败处理

OceanBase 数据库会锁定多次登录失败的用户，主要目的在于防止恶意的密码攻击，保护数据库，提升数据库的安全性。

## 登录失败处理策略

MySQL 模式下，使用系统变量 `connection_control_failed_connections_threshold` 来指定用户错误登录尝试的阀值。该变量是租户级变量，为整数类型，取值范围为 [0，2147483647]，默认值为 0。<ul><li> 当用户将参数设置为 0 时表示关闭该功能，即不对用户的错误登录尝试进行处理。</li><li>当取值为非 0 值时，待用户错误登录次数超过指定的值后，系统会对账户进行锁定。</li></ul>
当用户错误登录次数超过这个变量定义的值之后，会对账户进行锁定，锁定的时间参考下面的两个参数设置。
<ul><li><code>connection_control_min_connection_delay</code> :指定了超过错误登录次数阀值之后的第一次错误锁定账户的时长。之后的第二次错误登录的锁定时长为 <code>min（ connection_control_min_connection_delay+1000，1000* trunc ( connection_control_min_connection_delay/1000,0 )）</code>。再之后每次错误登录的锁定时间都在原来的基础上再加 1000 毫秒（ 1 秒）。</li></ul>

<ul><li><code>connection_control_max_connection_delay</code>：指定了错误链接锁定时长的最大值，当时长达到这个最大值之后就不再增长。</li></ul>

## 配置示例

1. 管理员登录到数据库的 MySQL 租户。
2. 执行以下语句，修改配置项 `connection_control_failed_connections_threshold`、`connection_control_min_connection_delay` 与 `connection_control_max_connection_delay` 的值。

    ```sql
    obclient> ALTER SYSTEM SET connection_control_failed_connections_threshold=5;

    obclient> ALTER SYSTEM SET connection_control_min_connection_delay=60000;

    obclient> ALTER SYSTEM SET connection_control_max_connection_delay=360000;
    ```

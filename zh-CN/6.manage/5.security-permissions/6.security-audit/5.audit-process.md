# 审计流程

审计检查的时机位于一条用户 SQL 执行完毕后准备回包之前。审计检查的流程如下：

1. 检查对当前用户是否进行审计，根据租户、用户名、配置项综合判断。
2. 解析 SQL 语句中可被审计的操作，一条 SQL 语句可以包含多个不同的操作，例如 insert into t1 select * from t2, t3 中包含了 (insert, t1), (select, t2), (select t3) 3 个操作。
3. 对每个操作单独判断是否命中任意一条审计规则。
4. 每个命中规则的操作单独产生一条审计记录。根据配置项，审计记录可以记录在内部表或文件中。